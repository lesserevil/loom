id: bd-017
type: task
title: P2 - Provider/model metrics + dynamic scoring (availability/latency/throughput)
description: |
  Add runtime metrics and a dynamic scoring system to rank provider-model
  candidates.

  Metrics
  - Track per-provider/per-model rolling metrics:
    - success/error rate
    - latency (TTFB if available; otherwise total duration)
    - throughput (tokens/sec when measurable)
    - last_seen_at
  - Persist aggregated metrics in config DB (schema TBD).

  Scoring
  - Compute a score combining:
    - availability/health
    - latency (lower is better)
    - throughput (higher is better)
    - future: dollar cost
  - Expose score in provider state and API responses.

  Instrumentation
  - Capture timing around provider chat completion calls.
  - Update rolling metrics upon each request.

  Acceptance Criteria
  - Scores exist and update over time based on real request data.
  - Provider negotiation uses the score when ranking models.
  - Scores/metrics are visible via API.

status: open
priority: 2
project_id: arbiter
assigned_to: null
blocked_by:
  - bd-015
  - bd-016
blocks: []
parent: bd-014
children: []
tags:
  - p2
  - scoring
  - metrics
  - providers
  - models
created_at: 2026-01-19T08:27:00Z
updated_at: 2026-01-19T08:27:00Z
closed_at: null
context:
  source: user-request
